<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Object类源码剖析一、Object类的简介Object类是类层次结构中的根类，每个类都使用它作为父类，所有的对象(包括数组)都实现了这个类中的方法。 1234567891011package test.lang;public class ObjectTest &amp;#123;    public static void main(String[] args) &amp;#123;        Objec">
<meta property="og:type" content="article">
<meta property="og:title" content="Object类源码剖析">
<meta property="og:url" content="https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/index.html">
<meta property="og:site_name" content="大军的秘密花园">
<meta property="og:description" content="Object类源码剖析一、Object类的简介Object类是类层次结构中的根类，每个类都使用它作为父类，所有的对象(包括数组)都实现了这个类中的方法。 1234567891011package test.lang;public class ObjectTest &amp;#123;    public static void main(String[] args) &amp;#123;        Objec">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hulingf.github.io/imgs/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/image-20230828095021829.png">
<meta property="og:image" content="https://hulingf.github.io/imgs/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/image-20230828110038008.png">
<meta property="og:image" content="https://hulingf.github.io/imgs/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/image-20230828094804268.png">
<meta property="og:image" content="https://hulingf.github.io/imgs/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/image-20230828120840697.png">
<meta property="og:image" content="https://hulingf.github.io/imgs/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/image-20230828125334524.png">
<meta property="og:image" content="https://hulingf.github.io/imgs/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/image-20230828122259455.png">
<meta property="og:image" content="https://hulingf.github.io/imgs/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/image-20230828122637309.png">
<meta property="og:image" content="https://hulingf.github.io/imgs/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/16317999bc121cddtplv-t2oaga2asx-jj-mark3024000q75.png">
<meta property="article:published_time" content="2023-08-28T01:28:42.093Z">
<meta property="article:modified_time" content="2023-10-03T14:10:37.704Z">
<meta property="article:author" content="hulingF">
<meta property="article:tag" content="JDK源码">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hulingf.github.io/imgs/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/image-20230828095021829.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Object类源码剖析</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/hulingF">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2023/09/06/Linux%20Fault%20Injection%E5%8E%9F%E7%90%86/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2023/08/14/Java%E5%9F%BA%E7%A1%80(%E4%BA%94)/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&text=Object类源码剖析"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&title=Object类源码剖析"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&is_video=false&description=Object类源码剖析"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Object类源码剖析&body=Check out this article: https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&title=Object类源码剖析"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&title=Object类源码剖析"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&title=Object类源码剖析"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&title=Object类源码剖析"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&name=Object类源码剖析&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&t=Object类源码剖析"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90"><span class="toc-number">1.</span> <span class="toc-text">Object类源码剖析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81Object%E7%B1%BB%E7%9A%84%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">一、Object类的简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81registerNatives%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="toc-number">1.2.</span> <span class="toc-text">二、registerNatives方法解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81getClass%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="toc-number">1.3.</span> <span class="toc-text">三、getClass方法解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81hashCode%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="toc-number">1.4.</span> <span class="toc-text">四、hashCode方法解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81equals%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="toc-number">1.5.</span> <span class="toc-text">五、equals方法解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81clone%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="toc-number">1.6.</span> <span class="toc-text">六、clone方法解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81toString%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="toc-number">1.7.</span> <span class="toc-text">七、toString方法解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81wait%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="toc-number">1.8.</span> <span class="toc-text">八、wait方法解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81notify%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="toc-number">1.9.</span> <span class="toc-text">九、notify方法解析</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Object类源码剖析
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">hulingF</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-08-28T01:28:42.093Z" class="dt-published" itemprop="datePublished">2023-08-28</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/JDK%E6%BA%90%E7%A0%81/" rel="tag">JDK源码</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="Object类源码剖析"><a href="#Object类源码剖析" class="headerlink" title="Object类源码剖析"></a>Object类源码剖析</h1><h2 id="一、Object类的简介"><a href="#一、Object类的简介" class="headerlink" title="一、Object类的简介"></a>一、Object类的简介</h2><p>Object类是类层次结构中的根类，每个类都使用它作为父类，所有的对象(包括数组)都实现了这个类中的方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> test.lang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ObjectTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">arr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>[<span class="number">5</span>];</span><br><span class="line">        System.out.println(o);</span><br><span class="line">        System.out.println(arr);</span><br><span class="line">        System.out.println(arr.getClass());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/../../../../../../imgs/Object类源码剖析/image-20230828095021829.png" alt="image-20230828095021829" style="zoom:50%;" />

<p>这里我们可以看出，数组也是一种类，上面代码中的<code>arr</code>就是一个数组对象，数组对象具有<code>length</code>字段，同样继承自<code>Object</code>类，能访问<code>toString</code>等一系列方法，甚至还可以通过<code>[]</code>使用下标访问数组元素。下面是一段验证代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数组也是一种类</span></span><br><span class="line">        <span class="type">int</span>[] is = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">5</span>];</span><br><span class="line">        Person[] ps = <span class="keyword">new</span> <span class="title class_">Person</span>[<span class="number">5</span>];</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o1</span> <span class="operator">=</span> ps;</span><br><span class="line">        <span class="type">int</span>[][] iss = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">5</span>][<span class="number">5</span>];</span><br><span class="line">        System.out.println(is.getClass().getName());</span><br><span class="line">        System.out.println(iss.getClass().getName());</span><br><span class="line">        System.out.println(o1.getClass().getName());</span><br><span class="line">        System.out.println(o1.getClass().getSuperclass().getName());</span><br><span class="line">        System.out.println(is.getClass().getSuperclass().getName());</span><br><span class="line">        System.out.println(iss.getClass().getSuperclass().getName());</span><br><span class="line">        System.out.println(o1 <span class="keyword">instanceof</span> Person[]);</span><br><span class="line">        <span class="comment">// 有一种特殊情况，假设B extends A，那么A[]可以引用B[]类型的对象</span></span><br><span class="line">        Object[] obs1 = <span class="keyword">new</span> <span class="title class_">Person</span>[<span class="number">3</span>];</span><br><span class="line">        <span class="comment">// 这种特性主要是用于方法中参数的传递。如果不传递数组，而是依次传递各个值，会使方法参数列表变得冗长。</span></span><br><span class="line">        <span class="comment">// 如果使用具体的数组类型，如String[]，那么就限定了类型，失去了灵活性，所以传递数组类型是一种比较好的方式。</span></span><br><span class="line">        <span class="comment">// 但是如果没有上面的数组特性（如果有两个类A和B，如果B继承（extends）了A，那么A[]类型的引用就可以指向B[]类型的对象），那么数组类型就只能通过Object类型接收，这样就无法在方法内部访问或遍历数组中的各个元素。</span></span><br><span class="line">        Object[] obs2 = &#123;<span class="string">&quot;aaa&quot;</span>, <span class="number">1</span>, <span class="number">2.5</span>&#125;;</span><br><span class="line">        System.out.println(obs1.getClass().getName());</span><br><span class="line">        System.out.println(obs2[<span class="number">0</span>].getClass().getName());</span><br><span class="line">        System.out.println(obs2[<span class="number">1</span>].getClass().getName());</span><br><span class="line">        System.out.println(obs2[<span class="number">2</span>].getClass().getName());</span><br></pre></td></tr></table></figure>

<img src="/../../../../../../imgs/Object类源码剖析/image-20230828110038008.png" alt="image-20230828110038008" style="zoom:50%;" />

<p>Object类非常有意思，其中包含与反射相关的<code>getClass</code>方法、经常使用的<code>toString</code>方法、哈希表的键中十分重要的<code>hashCode</code>和<code>equals</code>方法、拷贝复制相关的<code>clone</code>方法、线程通信相关的<code>wait</code>&#x2F;<code>notify</code>&#x2F;<code>notifyAll</code>方法以及跟本地方法映射相关的<code>registerNatives</code>方法。</p>
<img src="/../../../../../../imgs/Object类源码剖析/image-20230828094804268.png" alt="image-20230828094804268" style="zoom:50%;" />

<h2 id="二、registerNatives方法解析"><a href="#二、registerNatives方法解析" class="headerlink" title="二、registerNatives方法解析"></a>二、registerNatives方法解析</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">registerNatives</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        registerNatives();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>创建对象时，先调用静态代码块(即registerNatives()方法)。<code>native</code>关键字表示该方法不是由Java语言编写，而是通过C&#x2F;C++来完成的，并被编译成.dll 之后才由Java调用,方法的具体实现是在dll文件中。registerNatives()方法主要作用就是将C&#x2F;C++中的方法映射到Java中的native方法，实现方法命名的解耦。</p>
<p>registerNatives本质上就是一个本地方法，但这又是一个有别于一般本地方法的本地方法，从方法名我们可以猜测该方法应该是用来注册本地方法的。细心的你可能还会发现，在Object类中，除了有registerNatives这个本地方法之外，还有hashCode()、clone()等本地方法，而在Class类中有forName0()这样的本地方法等等。也就是说，凡是包含registerNatives()本地方法的类，同时也包含了其他本地方法。所以，显然，&#x3D;&#x3D;当包含registerNatives()方法的类被加载的时候，注册的方法就是该类所包含的除了registerNatives()方法以外的所有本地方法。&#x3D;&#x3D;</p>
<p>那么为什么要注册本地方法呢？</p>
<p>一个Java程序要想调用一个本地方法，需要执行两个步骤：第一，通过<code>System.loadLibrary()</code>将包含本地方法实现的动态文件加载进内存；第二，当Java程序需要调用本地方法时，虚拟机在加载的动态文件中<code>定位并链接</code>该本地方法，从而得以执行本地方法。registerNatives()方法的作用就是取代第二步，让程序<code>主动</code>将本地方法链接到调用方，当Java程序需要调用本地方法时就可以直接调用，而不需要虚拟机再去定位并链接。这样做有一些好处：</p>
<ul>
<li>通过registerNatives方法在类被加载的时候就主动将本地方法链接到调用方，比当方法被使用时再由虚拟机来定位和链接更方便有效。</li>
<li>如果本地方法在程序运行中更新了，可以通过调用registerNative方法进行更新。</li>
<li>Java程序需要调用一个本地应用提供的方法时，因为虚拟机只会检索本地动态库，因而虚拟机是无法定位到本地方法实现的，这个时候就只能使用registerNatives()方法进行主动链接。</li>
<li>通过registerNatives()方法，在定义本地方法实现的时候，可以不遵守JNI命名规范。</li>
</ul>
<blockquote>
<p>那什么是JNI命名规范呢？举个例子，我们在Object中定义的本地方法registerNatives，那这个方法对应的本地方法名就叫Java_java_lang_Object_registerNatives，而在System类中定义的registerNatives方法对应的本地方法名叫Java_java_lang_System_registerNatives等等。也就是说，JNI命名规范要求本地方法名由“包名”+“方法名”构成，我们将Java中定义的方法名“func”和本地方法名“func_impl”链接了起来，这就是通过registerNatives方法的第四个好处。</p>
</blockquote>
<h2 id="三、getClass方法解析"><a href="#三、getClass方法解析" class="headerlink" title="三、getClass方法解析"></a>三、getClass方法解析</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@HotSpotIntrinsicCandidate</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">native</span> Class&lt;?&gt; getClass();</span><br></pre></td></tr></table></figure>

<p>返回此对象的<code>运行时类</code>。返回的Class对象是由所表示类的<code>静态同步</code>方法锁定的对象。实际结果类型为Class&lt;？extensions|X|&gt;其中|X|是对调用getClass的表达式的静态类型的擦除。例如，在这个代码片段中不需要强制转换:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Number</span> <span class="variable">n</span> <span class="operator">=</span> <span class="number">0</span>;  </span><br><span class="line">Class&lt;? <span class="keyword">extends</span> <span class="title class_">Number</span>&gt; c = n.getClass();</span><br></pre></td></tr></table></figure>

<h2 id="四、hashCode方法解析"><a href="#四、hashCode方法解析" class="headerlink" title="四、hashCode方法解析"></a>四、hashCode方法解析</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@HotSpotIntrinsicCandidate</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">native</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>

<p>返回该对象的哈希值,支持此方法有利于哈希表的性能 比如由java.util.HashMap提供的哈希表哈希值的常规约定:在Java应用程序执行期间，在对同一对象多次调用hashCode方法时，必须一致地返回相同的整数。前提是对象进行比较时的euqals方法所用的信息没有被修改。从应用程序的一次执行到同一应用程序的另一次执行，该整数无需保持一致。</p>
<p>如果根据 equals(Object) 方法，两个对象是相等的，那么对这两个对象中的每个对象调用 hashCode 方法都必须生成相同的整数结果。如果根据 equals(java.lang.Object) 方法，两个对象不相等，那么对这两个对象中的任一对象上调用 hashCode方法不要求一定生成不同的整数结果。然而程序员应该意识到，<code>为不相等的对象生成不同整数结果可以提高哈希表的性能</code>。</p>
<p>实际上，由 Object 类定义的 hashCode 方法确实会针对不同的对象返回不同的整数。（这一般是通过将该对象的<code>内部地址</code>转换成一个整数来实现的，但是 Java编程语言不需要这种实现技巧。）</p>
<h2 id="五、equals方法解析"><a href="#五、equals方法解析" class="headerlink" title="五、equals方法解析"></a>五、equals方法解析</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object obj)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">this</span> == obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>equals方法在<code>非空对象</code>引用上实现相等关系：</p>
<ol>
<li>自反性：对于任何非空引用值 x，x.equals(x) 都应返回 true。</li>
<li>对称性：对于任何非空引用值 x 和 y，当且仅当 y.equals(x) 返回 true 时，x.equals(y) 也应返回 true。</li>
<li>传递性：对于任何非空引用值 x、y 和 z，如果 x.equals(y) 返回 true，并且 y.equals(z) 返回 true，那么 x.equals(z) 应返回 true。</li>
<li>一致性：对于任何非空引用值 x 和 y，多次调用 x.equals(y) 始终返回 true 或始终返回 false，前提是对象上 equals 比较中所用的信息没有被修改。</li>
</ol>
<p>对于任何非空引用值 x，x.equals(null) 都应返回 false。Object 类的 equals 方法实现判别<code>可能性最大</code>的相等关系；即，对于任何非空引用值 x 和 y， 当且仅当 x 和 y 引用<code>同一个对象</code>时，此方法才返回 true（x &#x3D;&#x3D; y 具有值 true）。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ObjectTest1</span> &#123;</span><br><span class="line">        String name;</span><br><span class="line">        <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span> == o) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (o == <span class="literal">null</span> || getClass() != o.getClass()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="type">ObjectTest1</span> <span class="variable">that</span> <span class="operator">=</span> (ObjectTest1) o;</span><br><span class="line">            <span class="keyword">return</span> age == that.age &amp;&amp; Objects.equals(name, that.name);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Objects.hash(name, age);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><em>注意：当此方法被重写时，通常有必要重写 hashCode 方法，以维护 hashCode 方法的常规约定，该约定声明相等对象必须具有相等的哈希码。</em></p>
<h2 id="六、clone方法解析"><a href="#六、clone方法解析" class="headerlink" title="六、clone方法解析"></a>六、clone方法解析</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@HotSpotIntrinsicCandidate</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">native</span> Object <span class="title function_">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException;</span><br></pre></td></tr></table></figure>

<p><img src="/../../../../../../imgs/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/image-20230828120840697.png" alt="image-20230828120840697"><br>按照惯例，此方法返回的对象应该独立于该对象（正被复制的对象)。要获得此独立性，在 super.clone 返回对象之前，有必要对该对象的一个或多个字段进行修改。这通常意味着要复制在被复制对象的内部“深层结构”的所有可变对象，并使用对副本的引用替换对这些对象的引用。&#x3D;&#x3D;如果一个类只包含原始字段或对不可变对象的引用，那么通常情况下，不需要修改由克隆返回的对象中的字段。&#x3D;&#x3D;<br>Object类的clone方法执行特定的复制操作。首先，如果此对象的类没有实现接口<code>Cloneable</code>，则会抛出 <code>CloneNotSupportedException</code>。</p>
<p><img src="/../../../../../../imgs/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/image-20230828125334524.png" alt="image-20230828125334524"></p>
<blockquote>
<p>注意，所有的数组都被视为实现接口Cloneable，且数组类型T[]的clone方法返回的类型是T[]，T可以是任何引用或基本类型<br>Object 类本身不实现接口Cloneable，所以在类为Object的对象上调用clone方法将会导致在运行时抛出异常。</p>
</blockquote>
<p>clone() 是 Object 的 <code>protected</code> 方法，它不是 public，一个类不显式去重写 clone()，其它类就不能直接去调用该类实例的 clone() 方法。<code>Object.clone</code>方法执行<code>浅拷贝</code>，如果对象中包含的域引用了<code>可变对象</code>，使用Object.clone可能会导致灾难性的后果。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ObjectCloneTest</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Stack</span> <span class="variable">stack</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Stack</span>();</span><br><span class="line">        <span class="type">Stack</span> <span class="variable">stack1</span> <span class="operator">=</span> (Stack) stack.clone();</span><br><span class="line">        stack1.push(<span class="number">1</span>);</span><br><span class="line">        System.out.println(stack.toString());<span class="comment">//Stack&#123;data=[1, null, null, null, null, null, null, null, null, null], size=0&#125;</span></span><br><span class="line">        System.out.println(stack1.toString());<span class="comment">//Stack&#123;data=[1, null, null, null, null, null, null, null, null, null], size=1&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Stack</span> <span class="keyword">implements</span> <span class="title class_">Cloneable</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Object[] data;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Stack</span><span class="params">()</span>&#123;</span><br><span class="line">        data = <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">10</span>];</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(Object elem)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(size == <span class="number">10</span>) <span class="keyword">return</span>;</span><br><span class="line">        data[size] = elem;</span><br><span class="line">        size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">pop</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(size == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        size --;</span><br><span class="line">        <span class="keyword">return</span> data[size];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getSize</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object[] getData() &#123;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Stack&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;data=&quot;</span> + Arrays.toString(data) +</span><br><span class="line">                <span class="string">&quot;, size=&quot;</span> + size +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Object <span class="title function_">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../../../../../../imgs/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/image-20230828122259455.png" alt="image-20230828122259455"></p>
<blockquote>
<p>只有可变对象的引用才会出现上述问题，<code>不可变类（IMMUTABLE CLASS）</code>的引用，如String、基本类型的包装类、BigInteger和BigDecimal等，每次对不可变对象的修改都将产生一个<code>新</code>的不可变对象，因此无论修改clone出的对象的可变对象，还是修改原对象中的可变对象，都会导致可变对象的引用值发生变化，而不是可变对象本身发生变化。</p>
</blockquote>
<p>由于浅拷贝并不能保证clone出的对象和原对象完全独立，所以在很多时候会导致这样那样的问题，子类覆盖clone一般都是实现深拷贝。</p>
<p>1.首先调用父类super.clone方法（父类必须实现clone方法），这个方法最终会调用Object中的clone方法完成浅拷贝。</p>
<p>2.对类中的引用类型进行单独拷贝。</p>
<p>3.检查clone中是否有不完全拷贝，进行额外的复制。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> Object <span class="title function_">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">      <span class="type">Stack</span> <span class="variable">cpyStack</span> <span class="operator">=</span> (Stack) <span class="built_in">super</span>.clone();</span><br><span class="line">      cpyStack.data = cpyStack.data.clone();</span><br><span class="line">      <span class="keyword">return</span> cpyStack;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../../../../../../imgs/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/image-20230828122637309.png" alt="image-20230828122637309"></p>
<h2 id="七、toString方法解析"><a href="#七、toString方法解析" class="headerlink" title="七、toString方法解析"></a>七、toString方法解析</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">     <span class="keyword">return</span> getClass().getName() + <span class="string">&quot;@&quot;</span> + Integer.toHexString(hashCode());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>返回该对象的字符串表示。通常，toString方法会返回一个“以文本方式表示”此对象的字符串。结果应是一个简明但易于读懂的信息表达式。建议所有子类都重写此方法。Object类的toString方法返回一个字符串，该字符串由类名（对象是该类的一个实例）、标记符“@”和此对象哈希码的无符号十六进制表示组成。</p>
<h2 id="八、wait方法解析"><a href="#八、wait方法解析" class="headerlink" title="八、wait方法解析"></a>八、wait方法解析</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">wait</span><span class="params">(<span class="type">long</span> timeoutMillis, <span class="type">int</span> nanos)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="keyword">if</span> (timeoutMillis &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;timeoutMillis value is negative&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (nanos &lt; <span class="number">0</span> || nanos &gt; <span class="number">999999</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(</span><br><span class="line">                                <span class="string">&quot;nanosecond timeout value out of range&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (nanos &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            timeoutMillis++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        wait(timeoutMillis);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在其他线程调用此对象的notify()方法或notifyAll()方法，或者超过指定的时间量前，导致当前线程等待。当前线程必须拥有此对象<code>监视器</code>。<br>此方法导致当前线程（称之为 T）将其自身放置在对象的<code>等待集</code>中，然后放弃此对象上的所有同步要求。出于线程调度目的，在发生以下四种情况之一前，线程 T 被禁用，且处于休眠状态:</p>
<ol>
<li>其他某个线程调用此对象的notify方法，并且线程 T 碰巧被任选为被唤醒的线程。</li>
<li>其他某个线程调用此对象的notifyAll方法</li>
<li>其他某个线程中断线程T</li>
<li>大约已经到达指定的实际时间。但是，如果timeout为零，则不考虑实际时间，在获得通知前该线程将一直等待。</li>
</ol>
<p>然后，从对象的<code>等待集</code>中删除线程T，并重新进行线程调度。然后，该线程以常规方式与其他线程竞争，以获得在该对象上同步的权利；一旦获得对该对象的控制权，该对象上的所有其同步声明都将被恢复到以前的状态， 这就是调用 wait 方法时的情况。然后，线程 T从wait方法的调用中返回。所以，从wait方法返回时，该对象和线程T的同步状态与调用wait方法时的情况完全相同<br>在没有被<code>通知</code>、<code>中断</code>或<code>超时</code>的情况下，线程还可以唤醒一个所谓的<code>虚假唤醒</code> (spurious wakeup)。 虽然这种情况在实践中很少发生，但是应用程序必须通过以下方式防止其发生， 即对应该导致该线程被唤醒的条件进行测试，如果不满足该条件，则继续等待。换句话说，等待应总是发生在循环中，如下面的示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span> (obj) &#123;      </span><br><span class="line">    <span class="keyword">while</span> (&lt;condition does not hold&gt; and &lt;timeout not exceeded&gt;) &#123;          </span><br><span class="line">        <span class="type">long</span> <span class="variable">timeoutMillis</span> <span class="operator">=</span> ... ; <span class="comment">// recompute timeout values          </span></span><br><span class="line">        <span class="type">int</span> <span class="variable">nanos</span> <span class="operator">=</span> ... ;          </span><br><span class="line">        obj.wait(timeoutMillis, nanos);      </span><br><span class="line">    &#125;      </span><br><span class="line">    ... <span class="comment">// Perform action appropriate to condition or timeout  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果当前线程在等待之前或在等待时被任何线程中断，则会抛出 InterruptedException。 &#x3D;&#x3D;这个异常直到在按上述形式恢复此对象的锁定状态时才会抛出。&#x3D;&#x3D;</p>
<blockquote>
<p>注意，由于wait方法将当前线程放入了对象的等待集中，所以它只能解除此对象的锁定；线程的任何其他对象在线程等待时仍处于锁定状态。</p>
</blockquote>
<h2 id="九、notify方法解析"><a href="#九、notify方法解析" class="headerlink" title="九、notify方法解析"></a>九、notify方法解析</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@HotSpotIntrinsicCandidate</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">notify</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>

<p><code>唤醒</code>在此<code>对象监视器</code>上等待的单个线程。如果多个线程都在此对象上等待，则会选择唤醒其中一个线程。 选择是任意性的，并在对实现做出决定时发生。线程通过调用其中一个<code>wait</code>方法，在对象的监视器上<code>等待</code>。<br>&#x3D;&#x3D;直到当前线程放弃此对象上的锁定，才能继续执行被唤醒的线程。&#x3D;&#x3D;被唤醒的线程将以常规方式与在该对象上主动<code>synchronize</code>的其他所有线程进行竞争；例如，唤醒的线程在作为锁定此对象的下一个线程方面没有可靠的优势或劣势。此方法只应由作为此对象监视器的所有者的线程来调用。 </p>
<p>通过以下三种方法之一，线程可以成为此对象监视器的所有者：</p>
<ol>
<li>通过执行此对象的同步实例方法。</li>
<li>通过执行在此对象上进行同步synchronized语句的正文。</li>
<li>对于Class类型的对象，可以通过执行该类的同步静态方法。</li>
</ol>
<blockquote>
<p>一次只能有一个线程拥有对象的监视器。</p>
</blockquote>
<p>:thinking: 使用wait&#x2F;notify的顺序：</p>
<ol>
<li>使用wait，notify和notifyAll时需要先对调用对象<code>加锁</code>。</li>
<li>调用wait方法后，线程状态由<code>Running</code>变为<code>Waiting</code>，并将当前线程放置到对象的<code>等待队列</code>。</li>
<li>notify或者notifyAll方法调用后，等待线程依旧不会从wait立刻返回，需要调用noitfy的线程<code>释放锁之后</code>，等待线程才有机会从 wait返回。</li>
<li>notify方法将等待队列的一个等待线程从等待队列转移到<code>同步队列</code>中，而notifyAll方法则是将等待队列中所有的线程全部移到同步队列，被移动的线程状态由<code>Waiting</code>变为<code>Blocked</code>。</li>
<li>从wait方法返回的前提是<code>获得了调用对象的锁</code>。</li>
</ol>
<p>从上述细节可以看到，等待&#x2F;通知机制依托于同步机制，其目的就是确保等待线程从wait方法返回后能够感知到通知线程对变量做出的修改。</p>
<p><img src="/../../../../../../imgs/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/16317999bc121cddtplv-t2oaga2asx-jj-mark3024000q75.png" alt="img"></p>
<p>WaitThread 获得了对象的锁，调用对象的 wait 方法，放弃了锁，进入了等待队列，然后 NotifyThread 拿到了对象的锁，然后调用对象的 notify 方法，将 WatiThread 移动到同步队列中，最后，NotifyThread 执行完毕，释放锁， WaitThread 再次获得锁并从 wait 方法返回继续执行。</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/tags/">Tag</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/hulingF">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90"><span class="toc-number">1.</span> <span class="toc-text">Object类源码剖析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81Object%E7%B1%BB%E7%9A%84%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">一、Object类的简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81registerNatives%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="toc-number">1.2.</span> <span class="toc-text">二、registerNatives方法解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81getClass%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="toc-number">1.3.</span> <span class="toc-text">三、getClass方法解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81hashCode%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="toc-number">1.4.</span> <span class="toc-text">四、hashCode方法解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81equals%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="toc-number">1.5.</span> <span class="toc-text">五、equals方法解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81clone%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="toc-number">1.6.</span> <span class="toc-text">六、clone方法解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81toString%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="toc-number">1.7.</span> <span class="toc-text">七、toString方法解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81wait%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="toc-number">1.8.</span> <span class="toc-text">八、wait方法解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81notify%E6%96%B9%E6%B3%95%E8%A7%A3%E6%9E%90"><span class="toc-number">1.9.</span> <span class="toc-text">九、notify方法解析</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&text=Object类源码剖析"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&title=Object类源码剖析"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&is_video=false&description=Object类源码剖析"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Object类源码剖析&body=Check out this article: https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&title=Object类源码剖析"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&title=Object类源码剖析"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&title=Object类源码剖析"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&title=Object类源码剖析"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&name=Object类源码剖析&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://hulingf.github.io/2023/08/28/Object%E7%B1%BB%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/&t=Object类源码剖析"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023
    hulingF
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/hulingF">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
